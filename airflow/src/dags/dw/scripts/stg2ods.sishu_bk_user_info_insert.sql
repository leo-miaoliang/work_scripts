-- This script was auto generated by dataship on 2019-03-07 15:22 

DROP TABLE  if exists tmp.tmp_bk_user_info; 
CREATE TABLE tmp.tmp_bk_user_info 
USING PARQUET
AS SELECT
  coalesce(t1.`id`, t2.`id`) as `id`,
  coalesce(t1.`uid`, t2.`uid`) as `uid`,
  coalesce(t1.`gh`, t2.`gh`) as `gh`,
  coalesce(t1.`realname`, t2.`realname`) as `realname`,
  coalesce(t1.`nickname`, t2.`nickname`) as `nickname`,
  coalesce(t1.`identity`, t2.`identity`) as `identity`,
  coalesce(t1.`sex`, t2.`sex`) as `sex`,
  coalesce(t1.`education`, t2.`education`) as `education`,
  coalesce(t1.`incumbent_school`, t2.`incumbent_school`) as `incumbent_school`,
  coalesce(t1.`teach_qualification`, t2.`teach_qualification`) as `teach_qualification`,
  coalesce(t1.`teach_years`, t2.`teach_years`) as `teach_years`,
  coalesce(t1.`dpid`, t2.`dpid`) as `dpid`,
  coalesce(t1.`dpparentid`, t2.`dpparentid`) as `dpparentid`,
  coalesce(t1.`birthday`, t2.`birthday`) as `birthday`,
  coalesce(t1.`addresses`, t2.`addresses`) as `addresses`,
  coalesce(t1.`phone`, t2.`phone`) as `phone`,
  coalesce(t1.`b_phone`, t2.`b_phone`) as `b_phone`,
  coalesce(t1.`sfz`, t2.`sfz`) as `sfz`,
  coalesce(t1.`country`, t2.`country`) as `country`,
  coalesce(t1.`jg`, t2.`jg`) as `jg`,
  coalesce(t1.`xl`, t2.`xl`) as `xl`,
  coalesce(t1.`mz`, t2.`mz`) as `mz`,
  coalesce(t1.`qq`, t2.`qq`) as `qq`,
  coalesce(t1.`msn`, t2.`msn`) as `msn`,
  coalesce(t1.`profile`, t2.`profile`) as `profile`,
  coalesce(t1.`jointime`, t2.`jointime`) as `jointime`,
  coalesce(t1.`photo`, t2.`photo`) as `photo`,
  coalesce(t1.`paytype`, t2.`paytype`) as `paytype`,
  coalesce(t1.`status`, t2.`status`) as `status`,
  coalesce(t1.`decription`, t2.`decription`) as `decription`,
  coalesce(t1.`sdexperience`, t2.`sdexperience`) as `sdexperience`,
  coalesce(t1.`gzexperience`, t2.`gzexperience`) as `gzexperience`,
  coalesce(t1.`iszz`, t2.`iszz`) as `iszz`,
  coalesce(t1.`lztime`, t2.`lztime`) as `lztime`,
  coalesce(t1.`tstime`, t2.`tstime`) as `tstime`,
  coalesce(t1.`fee_base`, t2.`fee_base`) as `fee_base`,
  coalesce(t1.`fee_zs`, t2.`fee_zs`) as `fee_zs`,
  coalesce(t1.`fee_zw`, t2.`fee_zw`) as `fee_zw`,
  coalesce(t1.`fee_jt`, t2.`fee_jt`) as `fee_jt`,
  coalesce(t1.`fee_grbx`, t2.`fee_grbx`) as `fee_grbx`,
  coalesce(t1.`fee_gsbx`, t2.`fee_gsbx`) as `fee_gsbx`,
  coalesce(t1.`fee_clpaytype`, t2.`fee_clpaytype`) as `fee_clpaytype`,
  coalesce(t1.`fee_onepaytype`, t2.`fee_onepaytype`) as `fee_onepaytype`,
  coalesce(t1.`fee_ptype`, t2.`fee_ptype`) as `fee_ptype`,
  coalesce(t1.`worktype_id`, t2.`worktype_id`) as `worktype_id`,
  coalesce(t1.`schoolsub`, t2.`schoolsub`) as `schoolsub`,
  coalesce(t1.`bank_no`, t2.`bank_no`) as `bank_no`,
  coalesce(t1.`bank_name`, t2.`bank_name`) as `bank_name`,
  coalesce(t1.`teacher_type`, t2.`teacher_type`) as `teacher_type`,
  coalesce(t1.`teacher_class`, t2.`teacher_class`) as `teacher_class`,
  coalesce(t1.`fee_adjustment`, t2.`fee_adjustment`) as `fee_adjustment`,
  coalesce(t1.`pp_id`, t2.`pp_id`) as `pp_id`,
  coalesce(t1.`cs_account`, t2.`cs_account`) as `cs_account`,
  coalesce(t1.`cs_account_pwd`, t2.`cs_account_pwd`) as `cs_account_pwd`,
  coalesce(t1.`self_introduction_video`, t2.`self_introduction_video`) as `self_introduction_video`,
  coalesce(t1.`teaching_style`, t2.`teaching_style`) as `teaching_style`,
  coalesce(t1.`personal_style`, t2.`personal_style`) as `personal_style`,
  coalesce(t1.`personal_synopsis`, t2.`personal_synopsis`) as `personal_synopsis`,
  coalesce(t1.`star_teacher`, t2.`star_teacher`) as `star_teacher`,
  coalesce(t1.`sign_info`, t2.`sign_info`) as `sign_info`,
  coalesce(t1.`score`, t2.`score`) as `score`,
  coalesce(t1.`teaching_form`, t2.`teaching_form`) as `teaching_form`,
  coalesce(t1.`selectable`, t2.`selectable`) as `selectable`,
  coalesce(t1.`create_time`, t2.`create_time`) as `create_time`,
  coalesce(t1.`update_time`, t2.`update_time`) as `update_time`,
  coalesce(t1.`new_teacher_type`, t2.`new_teacher_type`) as `new_teacher_type`,
  coalesce(t1.`load_time`, t2.`load_time`) as `load_time`
FROM(SELECT
    `id`, 
    `uid`, 
    `gh`, 
    `realname`, 
    `nickname`, 
    `identity`, 
    `sex`, 
    `education`, 
    `incumbent_school`, 
    `teach_qualification`, 
    `teach_years`, 
    `dpid`, 
    `dpparentid`, 
    `birthday`, 
    `addresses`, 
    `phone`, 
    `b_phone`, 
    `sfz`, 
    `country`, 
    `jg`, 
    `xl`, 
    `mz`, 
    `qq`, 
    `msn`, 
    `profile`, 
    `jointime`, 
    `photo`, 
    `paytype`, 
    `status`, 
    `decription`, 
    `sdexperience`, 
    `gzexperience`, 
    `iszz`, 
    `lztime`, 
    `tstime`, 
    `fee_base`, 
    `fee_zs`, 
    `fee_zw`, 
    `fee_jt`, 
    `fee_grbx`, 
    `fee_gsbx`, 
    `fee_clpaytype`, 
    `fee_onepaytype`, 
    `fee_ptype`, 
    `worktype_id`, 
    `schoolsub`, 
    `bank_no`, 
    `bank_name`, 
    `teacher_type`, 
    `teacher_class`, 
    `fee_adjustment`, 
    `pp_id`, 
    `cs_account`, 
    `cs_account_pwd`, 
    `self_introduction_video`, 
    `teaching_style`, 
    `personal_style`, 
    `personal_synopsis`, 
    `star_teacher`, 
    `sign_info`, 
    `score`, 
    `teaching_form`, 
    `selectable`, 
    `create_time`, 
    `update_time`, 
    `new_teacher_type`, 
    `load_time` 
  FROM stg.sishu_bk_user_info 
  WHERE etl_date = '{{ macros.ds(ti) }}' 
) AS t1
FULL JOIN  
  (SELECT 
    `id`, 
    `uid`, 
    `gh`, 
    `realname`, 
    `nickname`, 
    `identity`, 
    `sex`, 
    `education`, 
    `incumbent_school`, 
    `teach_qualification`, 
    `teach_years`, 
    `dpid`, 
    `dpparentid`, 
    `birthday`, 
    `addresses`, 
    `phone`, 
    `b_phone`, 
    `sfz`, 
    `country`, 
    `jg`, 
    `xl`, 
    `mz`, 
    `qq`, 
    `msn`, 
    `profile`, 
    `jointime`, 
    `photo`, 
    `paytype`, 
    `status`, 
    `decription`, 
    `sdexperience`, 
    `gzexperience`, 
    `iszz`, 
    `lztime`, 
    `tstime`, 
    `fee_base`, 
    `fee_zs`, 
    `fee_zw`, 
    `fee_jt`, 
    `fee_grbx`, 
    `fee_gsbx`, 
    `fee_clpaytype`, 
    `fee_onepaytype`, 
    `fee_ptype`, 
    `worktype_id`, 
    `schoolsub`, 
    `bank_no`, 
    `bank_name`, 
    `teacher_type`, 
    `teacher_class`, 
    `fee_adjustment`, 
    `pp_id`, 
    `cs_account`, 
    `cs_account_pwd`, 
    `self_introduction_video`, 
    `teaching_style`, 
    `personal_style`, 
    `personal_synopsis`, 
    `star_teacher`, 
    `sign_info`, 
    `score`, 
    `teaching_form`, 
    `selectable`, 
    `create_time`, 
    `update_time`, 
    `new_teacher_type`, 
    `load_time`
  FROM ods.sishu_bk_user_info 
) t2 
  ON t1.`id` = t2.`id`
;



INSERT OVERWRITE TABLE ods.sishu_bk_user_info  
SELECT
  `id`, 
  `uid`, 
  `gh`, 
  `realname`, 
  `nickname`, 
  `identity`, 
  `sex`, 
  `education`, 
  `incumbent_school`, 
  `teach_qualification`, 
  `teach_years`, 
  `dpid`, 
  `dpparentid`, 
  `birthday`, 
  `addresses`, 
  `phone`, 
  `b_phone`, 
  `sfz`, 
  `country`, 
  `jg`, 
  `xl`, 
  `mz`, 
  `qq`, 
  `msn`, 
  `profile`, 
  `jointime`, 
  `photo`, 
  `paytype`, 
  `status`, 
  `decription`, 
  `sdexperience`, 
  `gzexperience`, 
  `iszz`, 
  `lztime`, 
  `tstime`, 
  `fee_base`, 
  `fee_zs`, 
  `fee_zw`, 
  `fee_jt`, 
  `fee_grbx`, 
  `fee_gsbx`, 
  `fee_clpaytype`, 
  `fee_onepaytype`, 
  `fee_ptype`, 
  `worktype_id`, 
  `schoolsub`, 
  `bank_no`, 
  `bank_name`, 
  `teacher_type`, 
  `teacher_class`, 
  `fee_adjustment`, 
  `pp_id`, 
  `cs_account`, 
  `cs_account_pwd`, 
  `self_introduction_video`, 
  `teaching_style`, 
  `personal_style`, 
  `personal_synopsis`, 
  `star_teacher`, 
  `sign_info`, 
  `score`, 
  `teaching_form`, 
  `selectable`, 
  `create_time`, 
  `update_time`, 
  `new_teacher_type`, 
  `load_time`
FROM tmp.tmp_bk_user_info; 

